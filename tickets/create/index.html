<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BHIVE Support Ticket</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6DLVSE6YPJ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-6DLVSE6YPJ');
  </script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r); t.async=1; t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "q80i2gvsb2");
  </script>

  <style>
    /* Ensure the page and iframe fill the screen */
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      font-family: sans-serif;
      text-align: center;
    }
    iframe {
      border: none;
      width: 100%;
      height: 100%;
    }
    .error {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: #555;
    }
  </style>
</head>
<body>
  <!-- Full-page iframe (initially hidden) -->
  <iframe id="zohoForm" src="" style="display: none;"></iframe>

  <script>
    // Function to parse query parameters
    function getQueryParams() {
      var params = {};
      var queryString = window.location.search.substring(1);
      if(queryString) {
        queryString.split("&").forEach(function(pair) {
          var keyVal = pair.split("=");
          params[decodeURIComponent(keyVal[0])] = decodeURIComponent(keyVal[1] || "");
        });
      }
      return params;
    }

    // Required query parameters
    var requiredParams = ['company', 'center', 'floor', 'source_version', 'source'];

    // Get current query parameters
    var params = getQueryParams();

    // Check that all required parameters are present and non-empty
    var allPresent = requiredParams.every(function(param) {
      return params.hasOwnProperty(param) && params[param].trim() !== "";
    });

    if (!allPresent) {
      // Display a simple 404 error message if parameters are missing
      document.body.innerHTML = `
        <div class="error">
          <h1>404 Not Found</h1>
          <p>This page is not available.</p>
        </div>
      `;
    } else {
      // Construct the Zoho Forms URL by appending the query string to the fixed base URL
      var baseUrl = "https://zfrmz.in/GBnrlvIY56i9HDIrElvM";
      var fullUrl = baseUrl + window.location.search;

      // Set the iframe's source and display it
      var iframe = document.getElementById("zohoForm");
      iframe.src = fullUrl;
      iframe.style.display = "block";
    }
  </script>
</body>
</html>